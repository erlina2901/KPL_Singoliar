function(e){Object.keys(e).forEach(function(t){N(e,t)})};e(D),e(w),D={},w={}},U=function(e){N(w,e)},F=function(e){var t=e.getReference();N(D,t)},$=function(e){var t=e.getReference();return D[t]||(D[t]=P(e)),D[t]};i.stage.on("click",function(e){h.clearSelection()}),i.stage.on("mouseover",function(e){I()}),o.$watch("globalHovering",function(){R(!1,function(e){e.showOverlay=o.globalHovering}),o.globalHovering?C():I()});var B=p.getElementTypes(),j={};i.render=function(e,t){e?(D={},w={},i.stage.removeChildren()):k(),t||s.unloadAllTextures(e),i.reRender(e)},i.reRender=function(e){i.resize(e),j={},S.forEach(function(e){var t=p.getElementType(e);t&&(j[t]=j[t]||[],j[t].push(e))}),M(Object.keys(j)),Object.keys(j).forEach(function(e){var t=j[e];j[e]=f(t)}),i.layout()},i.layout=function(e){var t,n=2,r=i.scrollPosition||0,o=0,a=5-r,s=0,l=function(e){o=0,a+=s+n+(e||0),s=0},c=function(e){return a+e>=0&&a<=i.height},u=!0;if(B.forEach(function(r){var d=p.getElementTypeDimensions(r,g()),h=j[r]||[];if(0!==h.length){if(u||l(10),u=!1,!e)if(c(d.headerHeight)){var f=O(r);f.position(o,a)}else U(r);return a+=d.headerHeight,x[r]?(a-=8,void(e||h.forEach(F))):void h.forEach(function(r){if((g()||o+d.width>=i.width)&&l(),!e)if(c(d.height)){var u=$(r);u.position(o,a)}else F(r);r===e&&(t=a),g()||(o+=d.width+n),s=Math.max(s,d.height)})}}),l(2),i.setScrollHeight&&i.setScrollHeight({height:a+r}),e){var d=t+r,h=a+r,f=r,m=r+i.height;return void(d<f?i.setScrollPosition({position:Math.max(0,d-10)}):d>m&&i.setScrollPosition({position:Math.max(0,Math.min(h-i.height,d-10))}))}C()};var Y=function(){I(),i.setScrollPosition({position:0}),b(!0)};i.$watch("uiState.view",function(){i.render(!1,!0)}),i.$watch("uiState.sortFunction",function(){i.reRender()}),i.$watch("uiState.mode",function(e,t){if(Y(),!d.isSearchMode()){var n=h.getSelection()[0];"normal"===e&&"search"===t&&T&&n&&n.library.id===T.id||(h.clearSelection(),n=null),n&&setTimeout(function(){h.setSelection(n,!0),a.triggerDigest()})}}),d.addScopedListener(i,"search",function(e){b(),(d.isLibrarySearchMode()||d.isLibrariesSearchMode())&&(h.clearSelection(),l.reportPanelEvent(d.isLibrariesSearchMode()?"panelSearchAll":"panelSearch",{resultCount:S.length}))}),u.addScopedListener(i,"currentLibrary",Y),u.addScopedListener(i,"privateCollection",Y);var V=function(){R(!1,function(e){e.showDownloadProgressTooltip&&e.redraw(!0)})};u.addScopedListener(i,"libraryStatus",V);var H,G=!0;i.$watch("scrollPosition",function(){return H?void(G=!0):(i.layout(),void(H=setTimeout(function(){G&&i.layout(),G=!1,H=void 0},1e3/60)))}),h.addScopedListener(i,"selectionChanged",function(){R(!1,function(e){e.isSelected=h.isSelected(e.element),e.isSelected&&e.downloadProgress===-1&&p.retryElementDownload(e.element)});var e=h.getPendingScrollToItem();e&&(i.layout(e),h.clearPendingScrollToItem()),C()}),t.addScopedListener(i,"colorConstantsChanged",function(){s.updateRendererBackground(),i.render(!0)}),n.addScopedListener(i,"fontListChanged",function(){R(!1,function(e){e.redraw(!0)}),C()});var W=c.register(i);W.on("dlClearHover",function(){I()}),window.TEST_GET_ELEMENTS=function(){return j},window.TEST_HOVER_OVER_ELEMENT=function(e,t){var n=u.resolveElementReference(e);return n&&S.indexOf(n)!==-1?(i.layout(n),setTimeout(function(){var e=$(n);return e?(I(e),void setTimeout(function(){var e=document.getElementById("pixi-overlay"),n=document.createEvent("Events");n.initEvent("click",!0,!1),e.dispatchEvent(n),t(null)},100)):void t("error-scrolling-to-element")},100),!0):void t("element-not-in-library")}}]}}];t.attach=function(e){i.module(e).directive("pixiView",o)}}),define("directives/designlibrary/main",["require","exports","module","./designLibrary","./designLibraryArchive","./designLibraryComponent","./designLibraryContents","./designLibraryEditableName","./designLibraryFooter","./designLibraryShowMore","./designLibraryUndo","./dlCategory","./dlEmpty","./dlNoLibraries","./dlStock","./dlStockBadge","./dlVideoPreview","./pixiOverlay","./pixiView"],function(e,t,n){"use strict";function i(t){e("./designLibrary").attach(t),e("./designLibraryArchive").attach(t),e("./designLibraryComponent").attach(t),e("./designLibraryContents").attach(t),e("./designLibraryEditableName").attach(t),e("./designLibraryFooter").attach(t),e("./designLibraryShowMore").attach(t),e("./designLibraryUndo").attach(t),e("./dlCategory").attach(t),e("./dlEmpty").attach(t),e("./dlNoLibraries").attach(t),e("./dlStock").attach(t),e("./dlStockBadge").attach(t),e("./dlVideoPreview").attach(t),e("./pixiOverlay").attach(t),e("./pixiView").attach(t)}return{attach:i}}),define("directives/disclosureTriangle",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=[function(){return{restrict:"E",templateUrl:"directives/templates/disclosureTriangle.tmpl.html",replace:!0,scope:{ngModel:"="},controller:["$scope",function(e){e.$watch("ngModel",function(t){e.disclosureClass=t?"edgecc-core-panel-triangle-open":"edgecc-core-panel-triangle-closed"}),e.toggle=function(t){e.ngModel=!e.ngModel,t.preventDefault(),t.stopPropagation()}}]}}];t.attach=function(e){i.module(e).directive("edgeccDisclosureTriangle",r)}}),define("directives/edgeccTooltip",["require","exports","module","angular"],function(e,t,n){"use strict";var i,r=e("angular"),o=!1,a=!1,s=["Tether","configuration",function(e,t){return{scope:{content:"@tooltipContent",data:"=tooltipData",config:"=config",templateUrl:"=templateUrl",template:"=tooltipTemplate",disable:"="},link:function(n,s,l){a||(a=r.element('<div style="z-index:10000"></div>'),r.element(window.document.body).append(a));var c={parentScope:n,element:a,tether:{target:s[0],attachment:"bottom center",targetAttachment:"top center",constraints:[{to:"window",attachment:"together",pin:!0}]}};n.templateUrl?c.templateUrl=n.templateUrl:n.template?c.template=n.template:c.template='<div class="tooltip" ng-bind-html="content"></div>';var u,d,p=function e(t){return r.forEach(arguments,function(n){n!==t&&r.forEach(n,function(n,i){t[i]&&t[i].constructor&&t[i].constructor===Object?e(t[i],n):t[i]=n})}),t},h=p(c,n.config),f=e(h);n.$watch("templateUrl",function(){n.templateUrl&&(delete c.template,c.templateUrl=n.templateUrl)});var g=function(){return!!n.content||!!n.templateUrl||!!n.template},m=function(){f&&f.isActive()&&f.leave()},v=function(){f&&!f.isActive()&&!n.disable&&g()&&(clearTimeout(i),i=setTimeout(function(){o=!1},1e3),o=!0,f.enter(void 0,!0),d=setTimeout(m,7e3))},_=function(){"false"!==t.showTooltips&&!n.disable&&g()&&(u||(o?v():u=setTimeout(function(){v()},1e3)))},y=function(){"false"!==t.showTooltips&&(u&&(clearTimeout(u),u=void 0),d&&(clearTimeout(d),d=void 0),setTimeout(function(){f&&m()},0))},E=function(){f&&f.isActive()?y():_()};s.on("mouseenter",_),s.on("mouseleave",y),s.on("mousedown",E),n.$on("$destroy",function(){u&&(clearTimeout(u),u=void 0),f&&m(),f=void 0,s.off("mouseenter",_),s.off("mouseleave",y),s.off("mousedown",y)}),n.$watch("disable",function(e){e&&y()})}}}];t.attach=function(e){r.module(e).directive("edgeccTooltip",s)}}),define("directives/modalDialog",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=["csInterface",function(e){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"directives/templates/modalDialog.tmpl.html",scope:{titleText:"@",okText:"@",secondaryOkText:"@",cancelText:"@",onSubmit:"&",onCancel:"&",showDialog:"=",disableOk:"=",fullScreen:"@",errorMode:"="},link:function(t,n,i){var r=function(e){27===e.keyCode&&t.hideDialog()};window.addEventListener("keydown",r);var o=i.fullScreen?" panel-dialog-fullscreen":"";t.dialogClass="panel-dialog"+o,t.canCancel=!0,void 0!==i.noDismiss&&(t.dialogClass="panel-dialog-dim"+o,t.canCancel=!1),t.hideDialog=function(){t.canCancel&&(t.showDialog=!1,t.onCancel&&t.onCancel(),window.removeEventListener("keydown",r))},t.stopPropagation=function(e){e.stopPropagation()},t.doSubmit=function(){t.showDialog=!1,t.onSubmit&&t.onSubmit()(t.okText)},t.isWindowsOS=e.isWindowsOS()}}}];t.attach=function(e){i.module(e).directive("edgeccModalDialog",r)}}),define("directives/select",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=!1,o=["$window","Tether","configuration","$filter","menuManager","designLibraryFlyoutMenu","designLibraryManager","$translate","digestUtils","localSettings",function(e,t,n,o,a,s,l,c,u,d){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"directives/templates/select.tmpl.html",scope:{optionsArray:"=",modelField:"@",displayField:"@",ngModel:"=",ngDisabled:"=",ngChange:"&",maxHeight:"=",librarySelectionOnlyMode:"="},link:function(d,p,h){function f(e,t){for(var n=e,i=t;i;){if(i===n)return!0;i=i.parentNode}return!1}function g(e){d.selectedItem=void 0,d.optionsArray&&d.optionsArray.forEach(function(t){var n=d.modelField?t[d.modelField]:t;n===e&&(d.selectedItem=t);
})}r||(r=i.element("<div></div>"),i.element(window.document.body).append(r));var m={parentScope:d,templateUrl:"directives/templates/selectMenu.tmpl.html",element:r,tether:{target:p[0],attachment:"top left",targetAttachment:"bottom left",constraints:[{to:"window",attachment:"together",pin:!0}]}},v=0;n.currentProduct.config.offsetSelectMenu&&(m.tether.offset="-1px -1px",v=2);var _,y=t(m),E=!1,b=function(){E&&(p.removeClass("selected"),y.leave(),e.removeEventListener("click",_,!0),e.removeEventListener("contextmenu",_,!0),e.removeEventListener("resize",_,!0),e.removeEventListener("scroll",_,!0),a.removeListener("flyoutMenuClicked",_),a.removeListener("flyoutMenuOpened",_),E=!1)};_=function(e){f(r[0],e.target)||f(p[0],e.target)||b()},d.menuStyle={},d.scrollPosition={};var T=function(t){e.setTimeout(function(){d.scrollPosition.scrollToTop()});var n,i=18,r=5,o=3;d.isCreativeCloud&&!d.switchingEnabled||d.librarySelectionOnlyMode||o++,E||(d.menuStyle.width=p[0].offsetWidth+v,e.innerHeight?(n=e.innerHeight-o*i,n=d.maxHeight?Math.min(n,d.maxHeight):n):d.maxHeight&&(n=d.maxHeight),n&&n>0&&(n=Math.floor(n/i)*i+r,d.menuContainerStyle={"max-height":n+"px",overflow:"auto"}),e.addEventListener("click",_,!0),e.addEventListener("contextmenu",_,!0),e.addEventListener("resize",_,!0),e.addEventListener("scroll",_,!0),a.addListener("flyoutMenuClicked",_),a.addListener("flyoutMenuOpened",_),y.enter(),p.addClass("selected"),E=!0)};d.toggleMenu=function(e){E?b(e):T(e),e&&e.stopPropagation()},l.addListener("privateCollection",function(){var e=l.getPrivateLibraryCollection();e&&(d.isCreativeCloud=e.cloudId===n.CREATIVE_CLOUD_ID,d.collectionName=d.isCreativeCloud?c.instant("DL_MENU_PERSONAL_ASSETS"):e.cloudInfo.name,d.switchingEnabled=e.cloudInfo.switchingEnabled||!1)}),d.LIBRARY_MIN=n.RECENTS_LIST_LIBRARY_MIN,d.LIST_LIMIT=n.RECENTS_LIST_LIMIT,d.limitToFilterFunction=function(e,t,n){return n.length<=d.LIBRARY_MIN||t<d.LIST_LIMIT},d.orderByFunction=function(e){return e===d.selectedItem?Date.now():l.getLastAccess(e)},d.select=function(t){b(),d.ngModel=d.modelField?t[d.modelField]:t,d.ngChange&&e.setTimeout(function(){d.ngChange(),u.triggerDigest()})},d.showCreateDialog=function(){b(),s.invokeCreateLibrary()},d.changeCloud=function(){b(),l.requestCloudChange()},d.optionsArray&&d.optionsArray.length>d.LIBRARY_MIN&&(d.orderedLibraryList=o("localeOrderBy")(d.optionsArray,["name","-index"])),d.$watch("ngModel",function(e){g(e)}),d.$watch("optionsArray",function(e){e&&e.length>d.LIBRARY_MIN&&(d.orderedLibraryList=o("localeOrderBy")(e,["name","-index"])),d.selectedItem||g(d.ngModel)}),d.$watch("ngDisabled",function(e){e?p.addClass("disabled"):p.removeClass("disabled")})}}}];t.attach=function(e){i.module(e).directive("edgeccSelect",o)}}),define("directives/selectItem",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=["configuration",function(e){return{restrict:"E",replace:!0,templateUrl:"directives/templates/selectItem.tmpl.html",scope:{item:"=",selectedItem:"=",recent:"=",displayField:"@"}}}];t.attach=function(e){i.module(e).directive("selectItem",r)}}),define("directives/search",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=["$window","localSettings","designLibraryManager","designLibraryViewState","menuManager","$translate","digestUtils","designLibrarySelection",function(e,t,n,i,r,o,a,s){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"directives/templates/search.tmpl.html",scope:{disable:"="},link:function(n,l,c){function u(){n.uiState.modeParams.findSimilarData&&i.clearFindSimilarSearchMode(),(n.search.findSimilarId||n.search.findSimilarUrl)&&(n.search.findSimilarId=void 0,n.search.findSimilarUrl=void 0,n.search.text===y&&(n.search.text=""))}function d(){n.search.placeholder=o.instant("DL_SEARCH_INPUT_"+n.search.type.toUpperCase()+"_PLACEHOLDER")}function p(){n.search.text||n.search.findSimilarId?"search"!==n.uiState.mode&&i.setSearchMode(n.search):"search"===n.uiState.mode&&i.resetMode(),""!==n.search.text?n.showSearchCancel=!0:(n.showSearchCancel=!1,n.searchCancelHasFocus=!1)}function h(){n.uiState.modeParams!==n.search&&(n.uiState.modeParams=n.uiState.modeParams||{},n.uiState.modeParams.text=n.uiState.modeParams.text||n.search.text,n.uiState.modeParams.type=n.uiState.modeParams.type||n.search.type,n.search=n.uiState.modeParams,d(),p())}n.menuShown=!1;var f,g=t.getDebugValue("enableWebGL"),m=g?0:200,v=function(){n.menuShown&&(e.removeEventListener("click",f,!0),e.removeEventListener("contextmenu",f,!0),e.removeEventListener("resize",f,!0),e.removeEventListener("scroll",f,!0),r.removeListener("flyoutMenuClicked",f),r.removeListener("flyoutMenuOpened",f),n.menuShown=!1,a.triggerDigest())};f=function(e){n.isSearchDropDownTarget(e)||v()};var _=function(t){e.addEventListener("click",f,!0),e.addEventListener("contextmenu",f,!0),e.addEventListener("resize",f,!0),e.addEventListener("scroll",f,!0),r.addListener("flyoutMenuClicked",f),r.addListener("flyoutMenuOpened",f),n.menuShown=!0,a.triggerDigest()};n.toggleMenu=function(e){n.menuShown?v(e):n.disable||_(e)},n.searchFocused=function(e){n.menuShown&&v(),"focus"===e&&""!==n.search.text?n.showSearchCancel=!0:n.showSearchCancel=!1},n.cancelSearch=function(){n.search.text=""},n.uiState=i.getState(),n.types=i.getSearchTypes(),n.search={text:""};var y=o.instant("DL_STOCK_FIND_SIMILAR_PLACEHOLDER");n.setSearchType=function(e,t){n.search.type=e,t||i.setSearchType(n.search.type),p(),v()},n.setSearchType(i.getSearchType()||n.types[0],!0),n.$watch("uiState.modeParams",function(e){"search"===n.uiState.mode&&h()}),n.$watch("uiState.mode",function(e){"search"!==e?(n.search.text="",n.search.findSimilarId=void 0,n.search.findSimilarUrl=void 0):h()}),n.$watch("search.type",function(e){u(),n.search.text?i.notifySearchRequest():n.setFocus(!0,!1),d()}),n.$watch("search.text",function(){u(),s.clearSelection(),clearTimeout(n.searchAttemptTimeout),n.search.text&&(n.searchAttemptTimeout=setTimeout(function(){i.notifySearchRequest(),clearTimeout(n.searchAttemptTimeout)},i.isStockSearchMode()?1e3:m)),p()}),n.searchRequested=function(){u(),n.search.text?i.notifySearchRequest():n.setFocus(!1,!1)},s.addScopedListener(n,"selectionChanged",function(){n.search.text||n.setFocus(!1,!1)})}}}];t.attach=function(e){i.module(e).directive("edgeccSearch",r)}}),define("directives/insert",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=["$window","configuration","designLibraryManager","csInterface","designLibraryElements","menuManager","$translate","digestUtils","designLibrarySelection","layerSelectionManager","designLibraryViewState","localSettings","metrics",function(e,t,n,i,r,o,a,s,l,c,u,d,p){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"directives/templates/insert.tmpl.html",scope:{disabled:"=",library:"="},link:function(a,h,f){function g(e){var t=n.getPrivateLibraryCollection();t&&d.setValue(t.userId+"#"+t.cloudId+"#insertMenuSelectionState",e)}function m(){var e=n.getPrivateLibraryCollection();return e?d.getValue(e.userId+"#"+e.cloudId+"#insertMenuSelectionState")||{}:{}}function v(){var e=m();a.layerOperations.forEach(function(t){t.disabled||(e[t.name]=t.checked)}),g(e)}function _(){return a.layerOperations.filter(function(e){return!e.disabled}).length}function y(){return a.layerOperations.filter(function(e){return!e.checked}).length}function E(e,t){p.reportPanelEvent("insertMenu",{opType:e,libraryID:a.library&&a.library.id,totalElements:_(),checkedElements:y(),menuItem:t})}function b(){var t=c.getLayerInfo();a.layerOperations=r.getAddOperations(t,a.library);var n=e.innerHeight-32,i=47,o=0,l=!1,u=m();a.layerOperations.forEach(function(e){e.checked=!e.disabled&&u[e.name]!==!1,e.checked&&o++,e.disabled||(l=!0),i=e.disabled?i:i+24}),0===o&&a.layerOperations.forEach(function(e){e.checked=!e.disabled}),v();var d=e.innerWidth-12;return i<n?a.menuStyle={overflow:"hidden","max-width":d}:a.menuStyle={"overflow-y":"scroll","overflow-x":"hidden",height:n,"max-width":d},s.triggerDigest(),l}function T(){var e=b();E("update"),e||S()}var S;a.isWindowsOS=i.isWindowsOS(),a.showMenu=function(){a.menuShown=b(),a.menuShown&&(E("render"),e.addEventListener("click",S,!0),e.addEventListener("contextmenu",S,!0),e.addEventListener("resize",S,!0),e.addEventListener("scroll",S,!0),c.addListener("layerSelectionChanged",T),o.addListener("flyoutMenuClicked",S),o.addListener("flyoutMenuOpened",S))},a.menuStyle={"max-height":500};var L=function(){e.removeEventListener("click",S,!0),e.removeEventListener("contextmenu",S,!0),e.removeEventListener("resize",S,!0),e.removeEventListener("scroll",S,!0),c.removeListener("layerSelectionChanged",T),o.removeListener("flyoutMenuClicked",S),o.removeListener("flyoutMenuOpened",S),a.menuShown=!1,s.triggerDigest()};a.toggleMenu=function(){a.menuShown?a.hideMenu():a.showMenu()},a.insertSelection=function(){if(L(),a.library){l.clearSelection();var e=a.layerOperations.filter(function(e){return e.checked}),n=function(){e.forEach(function(e){e.apply(a.library,"addButton").then(function(e){u.resetMode(),l.toggleSelectedItem(e)})}),E("add")},i=t.currentProduct.confirmAddOperation;if(i)return void i(e).then(n);n()}},a.selectionChanged=function(e){v(),E(e.checked?"checked":"unchecked",e.name)},a.isAddDisabled=function(){return!a.layerOperations.reduce(function(e,t){return e.checked?e:t}).checked},a.hideMenu=function(){L(),E("cancel")},a.layerOperations=[],S=function(e){e&&a.isAddMenuTarget(e)||(L(),E("quit"))},a.menuShown=!1}}}];t.attach=function(e){i.module(e).directive("edgeccInsert",r)}}),define("directives/main",["require","exports","module","./core/main","./designlibrary/main","./disclosureTriangle","./edgeccTooltip","./modalDialog","./select","./selectItem","./search","./insert"],function(e,t,n){"use strict";t.attach=function(t){e("./core/main").attach(t),e("./designlibrary/main").attach(t),e("./disclosureTriangle").attach(t),e("./edgeccTooltip").attach(t),e("./modalDialog").attach(t),e("./select").attach(t),e("./selectItem").attach(t),e("./search").attach(t),e("./insert").attach(t)}}),define("controllers/purchaseCtrl",["require","exports","module"],function(e,t,n){"use strict";var i=["$scope","$rootScope","$document","$window","$translate","csInterface","designLibraryManager","adobeStockLicenseUtils","configuration","adobeStockUtils","metrics","debugLog","designLibraryViewState","$sce","linkUtils",function(e,t,n,i,r,o,a,s,l,c,u,d,p,h,f){var g=360,m=360,v=600,_=140,y=180,E=30;e.lang=o.getLocale(),e.cssClasses={windows:o.isWindowsOS()},e.cssClasses["locale_"+e.lang]=!0,e.showSpinner=!0,d.log("Loading Purchase Dialog extention");var b=r.instant("DL_CANCEL"),T=r.instant("DL_SEARCH_STOCK");o.setWindowTitle(T),e.stockPurchaseDialog={title:T,text:" ",cancelText:b},e.isErrorMode=!1,e.showStockDialog=function(t,n,i,r,a,s,l){if(e.showSpinner=!1,e.stockPurchaseDialog.title=t,e.stockPurchaseDialog.okCallback=i,e.stockPurchaseDialog.okText=a||"DL_OK",e.stockPurchaseDialog.secondaryOkText=s,e.stockPurchaseDialog.agencyForm=l,"string"==typeof n?e.stockPurchaseDialog.message=[{text:n}]:e.stockPurchaseDialog.message=n,e.launchLicenseURL=function(e){f.launchLicenseURL(e)},l){e.formContainer={},e.mandatoryFormFields=[],e.optionalFormFields=[],e.maxCharacters=64,e.placeholderCharacters=40;var c=4;l.forEach(function(t){t.value=void 0,e.placeholderCharacters=Math.max(t.text.length+c,e.placeholderCharacters),t.required?e.mandatoryFormFields.push(t):e.optionalFormFields.push(t)})}var u=m,d=_;if(l){e.mandatoryFormFields.length>0&&e.optionalFormFields.length>0?u=v:0!==e.mandatoryFormFields.length&&0!==e.optionalFormFields.length||(u=m);var p=27,h=Math.max(e.mandatoryFormFields.length,e.optionalFormFields.length);d=p*h+200}n.length>1&&(d+=E),o.resizeContent(u,d),e.isErrorMode=!i&&!r,e.isErrorMode?(e.stockPurchaseDialog.okCallback=e.cancelStockPurchase,e.stockPurchaseDialog.cancelText=void 0):e.stockPurchaseDialog.cancelText=b},s.addScopedListener(e,"showStockPurchaseDialog",function(t,n,i,r,o,a,s){e.showStockDialog(t,n,i,r,o,a,s)});var S,L,A=function(e,t){u.flush(),e.createdElementRef&&(L=e.createdElementRef);var n=o.createEvent("com.adobe.inapp.purchase.closed","APPLICATION","AdobeStockPurchaseDialog",o.getExtensionID());n.data={data:e,didFinish:t,initiatedBy:S,elementRef:L},o.dispatchEvent(n),d.log("SENT : com.adobe.inapp.purchase.closed event"),d.log(JSON.stringify(n.data)),o.closeExtension()};e.cancelStockPurchase=function(){A("CANCELLED",!1)};var C=function(){e.chooseLibraryMode=!1,e.showSpinner=!0,e.stockPurchaseDialog.text=" ",e.stockPurchaseDialog.okText=void 0,e.stockPurchaseDialog.secondaryOkText=void 0},w=function(t){e.showStockDialog("DL_STOCK_PURCHASE_CHOOSE_LIB_TITLE",r.instant("DL_STOCK_PURCHASE_CHOOSE_LIB_MSG"),t),e.stockPurchaseDialog.cancelText=void 0,o.resizeContent(g,y),e.uiState=p.getState(),e.library=a.getCurrentLibrary(),e.libraries=a.getLibraries(),e.showSpinner=!1,e.chooseLibraryMode=!0};e.okCallback=function(t){C(),e.stockPurchaseDialog.okCallback&&e.stockPurchaseDialog.okCallback(t)};var x=function(t){e.stockPurchaseDialog.title=r.instant("DL_STOCK_PURCHASE_DIALOG_TITLE"+c.getLocalizationSuffix({type:t}))},O=function(e){return e&&""!==e?e:void 0},D=function(t){d.log("RECEIVED : com.adobe.inapp.purchase.perform event, event.appId="+t.appId),d.log(JSON.stringify(t.data)),S=t.appId,u.setEnvironment({consumer:S}),L=O(t.data.elementRef);var n=O(t.data.elementType),i=O(t.data.elementName),r=O(t.data.contentId),o=O(t.data.skipQuotaCheck),p=O(t.data.licenseType),h=O(t.data.addToLibraryID),f=O(t.data.metadata),g=O(t.data.renditionDetails),m=O(t.data.stockSearchAsset);f||(f={method:t.appId}),a.waitForInitialLoad().then(function(){d.log("designLibraryManager initialized");var t,u=a.getPrivateLibraryCollection().userId;if(L&&(t=a.resolveElementReference(L),t&&(d.log("Resolved elementRef with elementType = "+t.type),n=t.type,i=t.name,r=c.getStockId(t),o=c.isLicensed(t)))){var v=c.getStockDataForElement(t);v&&v.license&&(p=v.license)}if(!n||!u||!r)return void A("INSUFFICIENT_DETAILS",!1);t||(t={type:n,name:i}),x(n);var _,y=function(e){A(e,!0)},E=function(n){return n&&"LIBRARY_NOT_WRITEABLE"===n.code?void w(function(){C(),t.hasOwnProperty("_library")?t.getThumbnailPath(l.IMAGE_RENDITION_SIZE,function(t,i){i&&(g={path:i,width:l.IMAGE_RENDITION_SIZE,height:l.IMAGE_RENDITION_SIZE}),_(!0,n.licenseType,e.library.id)}):_(!0,n.licenseType,e.library.id)}):void(e.isErrorMode||A(n,!1))};(_=function(e,n,i){s.doLicense(t,u,r,e,n,i,g,m,f).then(y,E)})(o,p,h)})};o.addEventListener("com.adobe.inapp.purchase.perform",D);var R=o.createEvent("com.adobe.inapp.purchase.init","APPLICATION","AdobeStockPurchaseDialog",o.getExtensionID());R.data="",o.dispatchEvent(R),d.log("SENT : com.adobe.inapp.purchase.init event")}];t.attach=function(e){angular.module(e).controller("purchaseCtrl",i)}}),define("controllers/mainCtrl",["require","exports","module"],function(e,t,n){"use strict";var i=["$scope","$rootScope","$document","$window","csInterface","designLibraryManager",function(e,t,n,i,r,o){var a=r.getLocale();e.lang=a.split("-")[0],"zh-TW"===a?e.lang="zh-Hant":"zh-CN"===a&&(e.lang="zh-Hans"),e.cssClasses={windows:r.isWindowsOS()},e.cssClasses["locale_"+a]=!0,n.on("click",function(){o.sync(!0,!0)}),i.addEventListener("online",function(){o.sync()}),i.addEventListener("offline",function(){o.sync()}),n.on("mouseenter",function(){t.globalHovering=!0,t.$apply()}),n.on("mouseleave",function(){t.globalHovering=!1,t.$apply()})}];t.attach=function(e){angular.module(e).controller("mainCtrl",i)}}),define("controllers/main",["require","exports","module","environment","./purchaseCtrl","./mainCtrl"],function(e,t,n){"use strict";t.attach=function(t){var n=e("environment");n.isLibrariesPanel?e("./mainCtrl").attach(t):e("./purchaseCtrl").attach(t)}}),define("filters/timeago",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=function(){return function(e){return moment(e).from(moment())}};t.attach=function(e){i.module(e).filter("timeago",r)}}),define("filters/localeOrderBy",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=["$parse","csInterface",function(e,t){var n=new Intl.Collator(t.getLocale(),{numeric:!0});return function(t,r,o,a){var s=function(e,t,n){var r=[];return i.forEach(e,function(e,i,o){r.push(t.call(n,e,i,o))}),r},l=function(e,t){var n,i;for(n=0;n<r.length;n++)if(i=r[n](e,t),0!==i)return i;return 0},c=function(e,t){return t?function(t,n){return e(n,t)}:e},u=function(e,t){if(e===t)return 0;var r=typeof e,o=typeof t;return r===o?"string"===r?n.compare(e,t):(i.isDate(e)&&i.isDate(t)&&(e=e.valueOf(),t=t.valueOf()),e<t?-1:1):r<o?-1:1};if(!i.isArray(t))return t;if(!r)return t;r=i.isArray(r)?r:[r],r=s(r,function(t){var n=!1,r=t||identity;if(i.isString(t)&&("+"!==t.charAt(0)&&"-"!==t.charAt(0)||(n="-"===t.charAt(0),t=t.substring(1)),r=e(t),r.constant)){var o=r();return c(function(e,t){return u(e[o],t[o])},n)}return c(function(e,t){return u(r(e),r(t))},n)});var d;if(o)d=t;else{d=[];var p;for(p=0;p<t.length;p++)d.push(t[p])}return d.sort(c(l,a))}}];t.attach=function(e){i.module(e).filter("localeOrderBy",r)}}),define("filters/searchKeyword",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r=[function(){return function(e,t,n){if(!t)return e;if(t=t.trim().toLowerCase(),0===t.length)return e;var i;i=t.length>1&&'"'===t.charAt(0)&&'"'===t.charAt(t.length-1)?[t.substring(1,t.length-1)]:t.indexOf(" ")>-1?t.split(/[ ]+/):[t];var r=[];return e.forEach(function(e){n?n(e,i)&&r.push(e):i.every(function(t){return e.name.toLowerCase().indexOf(t)>-1})&&r.push(e)}),r}}];t.attach=function(e){i.module(e).filter("searchKeyword",r)}}),define("filters/main",["require","exports","module","./timeago","./localeOrderBy","./searchKeyword"],function(e,t,n){"use strict";function i(t){e("./timeago").attach(t),e("./localeOrderBy").attach(t),e("./searchKeyword").attach(t)}return{attach:i}}),define("configuration/designlibrary/brush/config",["require","exports","module","angular"],function(e,t,n){"use strict";var i=e("angular"),r={"application/vnd.adobe.scatter.brush+zip":"DL_BRUSHTYPE_SCATTER","application/vnd.adobe.vector.brush+zip":"DL_BRUSHTYPE_VECTOR","application/vnd.adobe.ribbon.brush+zip":"DL_BRUSHTYPE_RIBBON","image/x-adobe-photoshop-brush":"DL_BRUSHTYPE_SCATTER"},o=function(e){i.module(e).run(["designLibraryElements","configuration","imageUtils",function(e,t,n){e.register({type:t.BRUSH_ELEMENT_TYPE,directive:"dl-brush",displayName:"DL_TYPE_BRUSH",tooltipTemplateUrl:"configuration/designlibrary/brush/tooltip.tmpl.html",renditionSize:t.BRUSH_RENDITION_SIZE,getAddOperations:function(e){return[]},width:103,height:43,listHeight:32,listExpandOnHover:!0,backgroundColor:16777215,getAdditionalTooltipData:function(n){var i={},o=n.getPrimaryRepresentation();return o&&o.type&&(i.brushType=r[o.type]),e.isElementUsable(n)||(i.disabledMessage="DL_ERROR_BRUSH_NOT_SUPPORTED_"+t.currentProduct.config.translationSuffix),i}})}])};return{attach:o}}),define("configuration/designlibrary/brush/renderer",["require","exports","module","angular"],function(e,t,n){"use strict";function i(e){r.module(e).directive("dlBrush",a)}var r=e("angular"),o={"application/vnd.adobe.scatter.brush+zip":"DL_BRUSHTYPE_SCATTER","application/vnd.adobe.vector.brush+zip":"DL_BRUSHTYPE_VECTOR","application/vnd.adobe.ribbon.brush+zip":"DL_BRUSHTYPE_RIBBON","image/x-adobe-photoshop-brush":"DL_BRUSHTYPE_SCATTER"},a=["fileUtils",function(e){return{restrict:"E",replace:!1,templateUrl:"configuration/designlibrary/brush/view.tmpl.html",scope:{component:"="},link:function(e,t,n){e.scrollIntoView=function(){t[0].scrollIntoView(!0)}},controller:["$scope","$window","designLibrarySelection","configuration","designLibraryElements","designLibraryViewState","digestUtils",function(t,n,i,a,s,l,c){function u(){t.tooltip.name=s.getTruncatedElementName(t.component);var n=!1;s.setLoadingTimeout(function(){if(!n)return t.imageUrl=void 0,t.loadedRenditionUrl=!1,!0}),s.getRenditionUrl(t.component).then(function(e){n=!0,t.imageUrl=e,t.loadedRenditionUrl=!0},function(e){n=!0,t.imageUrl=void 0,t.loadedRenditionUrl=!0});var i=t.component.getPrimaryRepresentation();if(i){var r=i.type;r&&(t.tooltip.brushType=o[i.type])}var c=e.getUsableTypes(t.component.type),u=t.component.representations.filter(function(e){var t="rendition"===e.relationship,n=s.isRepresentationCompatible(e,c);return!t&&n});t.disabled=0===u.length,t.disabled&&(t.tooltip.disabledMessage="DL_ERROR_BRUSH_NOT_SUPPORTED_"+a.currentProduct.config.translationSuffix),l.isLibrariesSearchMode()&&(t.tooltip.libraryName=t.component.library.name)}function d(){u(),c.triggerDigest()}function p(){t.selected=i.isSelected(t.component),i.isPendingScrollToItem(t.component)&&(i.clearPendingScrollToItem(),n.setTimeout(function(){t.scrollIntoView()}))}t.uiState=l.getState(),t.tooltip={},i.addScopedListener(t,"selectionChanged",p),u(),p(),t.component.addChangeListener(d),t.$on("$destroy",function(){t.component&&t.component.removeChangeListener(d),t.scrollIntoView=r.identity})}]}}];return{attach:i}}),define("configuration/designlibrary/brush/main",["require","exports","module","./config","./renderer"],function(e,t){"use strict";t.attach=function(t){e("./config").attach(t),e("./renderer").attach(t)}}),define("configuration/designlibrary/color/config",["require","exports","module","angular","pixi"],function(e,t,n){"use strict";var i=e("angular"),r=e("pixi"),o=function(e){i.module(e).run(["$q","designLibraryElements","designLibraryUtils","colorUtils","pngUtils","configuration",function(e,t,n,i,o,a){t.register({type:a.COLOR_ELEMENT_TYPE,directive:"dl-color",displayName:"DL_TYPE_COLOR",tooltipTemplateUrl:"configuration/designlibrary/color/tooltip.tmpl.html",getAddOperations:function(t){var r=function(t){return{apply:function(i,r){var o=e.defer(),s=t.name;s||(t.data[0]&&t.data[0].type&&"spot"===t.data[0].type&&(s=t.data[0].spotColorName),s=s||"");var l=n.createElementExtraMetrics(i,s,a.COLOR_ELEMENT_TYPE,{opType:r});return t.data.forEach(function(e,t){var n=0===t?"primary":"rendition",i=l.createRepresentation(a.COLOR_REPRESENTATION_TYPE,n);i.setValue(a.COLOR_NAMESPACE,a.COLOR_DATA_KEY,e)}),l.endOperation(),o.resolve(l),o.promise}}},o=[];return t&&t.colors&&t.colors.length>0?(t.colors.forEach(function(e){var t=e.data;if(t&&""!==t){var n=r(e);o.push({name:"DL_ADD_COLOR_NAME_"+e.colorType,order:4,toolTipData:{primaryValue:Array.isArray(t)?i.getStringColorValue(t[0]):null,hexValue:i.colorDataToHexValue(t).toUpperCase(),name:t.name},toolTipTemplate:"configuration/designlibrary/color/tooltip.tmpl.html",style:{"background-color":i.colorDataToHexValue(t),border:"1px solid",width:"14px",height:"14px",margin:"1px 1px 1px 0px"},apply:n.apply,displayIcon:!0})}}),o):[{name:"DL_ADD_COLOR_NAME",order:4,style:{border:"1px solid",width:"14px",height:"14px",margin:"1px 1px 1px 0px"},disabled:!0,displayIcon:!0}]},getDisplayText:function(e){if(e.name&&""!==e.name)return e.name;var t=e.representations.filter(function(e){var t=e.getValue("color","data");return"RGB"===t.mode}),n=t.length>0?t[0]:void 0,r=n&&n.getValue("color","data");return r?i.colorDataToHexValue(r).toUpperCase():""},elementFilter:function(e,t){var n,r=e.representations.filter(function(e){var t=e.getValue("color","data");return"RGB"===t.mode}),o=r.length>0?r[0]:void 0,a=o&&o.getValue("color","data");return a&&(n=i.colorDataToHexValue(a).toLowerCase()),t.every(function(t){return e.name.toLowerCase().indexOf(t)>-1||!!n&&n.indexOf(t)>-1})},getRenditionUrl:function(t){var n=e.defer(),i=t.representations.filter(function(e){var t=e.getValue("color","data");return"RGB"===t.mode}),r=i[0]&&i[0].getValue("color","data");if(r){var a=o.createPNG(200,200,256);a.color(Math.round(r.value.r),Math.round(r.value.g),Math.round(r.value.b),255);var s="data:image/png;base64,"+a.getBase64();n.resolve(s)}else n.reject();return n.promise},allowBlankName:!0,width:68,height:45,listHeight:20,listThumbHeight:16,disableDefaultRender:!0,render:function(e,t){e._colorGraphics||(e._colorGraphics=new r.Graphics,e.sprite.addChildAt(e._colorGraphics,t),e.onDestroy(function(){e._colorGraphics.destroy()})),e._colorGraphics.clear();var n=e.element.representations.filter(function(e){var t=e.getValue("color","data");return"RGB"===t.mode}),o=n[0]&&n[0].getValue("color","data");if(o){var a=i.colorDataToHexNumber(o);e._colorGraphics.beginFill(a),e._colorGraphics.drawRect(e.border+e.thumbnailOffsetX,e.border+e.thumbnailOffsetY,e.thumbnailWidth-2*e.border,e.thumbnailHeight-2*e.border),e._colorGraphics.endFill()}},getAdditionalTooltipData:function(e){var t={},n=e.getPrimaryRepresentation(),r=n&&n.getValue("color","data");r&&(t.primaryValue=i.getStringColorValue(r));var o=e.representations.filter(function(e){var t=e.getValue("color","data");return"RGB"===t.mode});if(n=o.length>0?o[0]:void 0,r=n&&n.getValue("color","data")){var a=i.colorDataToHexValue([r]).toUpperCase();t.hexValue=a}return t}})}])};return{attach:o}}),define("configuration/designlibrary/color/renderer",["require","exports","module","angular"],function(e,t,n){"use strict";function i(e){r.module(e).directive("dlColor",o)}var r=e("angular"),o=["fileUtils",functio